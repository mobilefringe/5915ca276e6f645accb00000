<div class="events_banner text-center">
    <h3>IMAGE GALLERY</h3>
    <p>explore • enjoy • shop</p>
</div>
<div class="store_list_head main_container">
    <div class="row hidden_phone">
        <div class="col-md-4">
            <h5 class="active_heading">IMAGE GALLERY</h5>
        </div>
        <div class="col-md-4">
            <h5><a href="/newsletter">NEWSLETTER SIGN-UP</a></h5>
        </div>
        <div class="col-md-4">
            <h5><a href="/whats_happening">WHAT'S HAPPENING</a></h5>
        </div>
    </div>
    <h5 class="text-center tap_here show_phone">
        <select id="option_selector" class="link_selector">
            <option value="" disabled selected>TAP FOR MORE OPTIONS</option>
            <option value="/newsletter">Newsletter Sign-Up</option>
            <option value="/whats_happening">What's Happening</option>
        </select>
    </h5>
</div>
 <div class="content_container main_container">
    <div class="margin_25_across">
        <div class="row">
            <div class="col-md-12">
                <div class="portfolio_container">
                    <script id="photo_template" type="x-tmpl-mustache/text">
                        <div class="portfolio_item"> 
                            <a href="{{alt_url}}" rel="lightbox-gallery" title="{{name}}">
                                <img alt="photo{{id}}" src="{{alt_url}}"/>
                            </a>
                        </div>
                    </script>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    $(document).ready(function(e){
        init(e);
        function renderAll(){
            var gallery_repo = getRepoDetailsByName("Image Gallery").images;
            if(gallery_repo != null){
                renderPhotos("#photo_container", "#photo_template", gallery_repo);
            }
            
            show_content();
        }
        
        function renderPhotos(container, template, collection){
            var item_list = [];
            var item_rendered = [];
            var template_html = $(template).html();
            Mustache.parse(template_html);   // optional, speeds up future uses
            $.each( collection , function( key, val ) {
                if( val.name == "photos"){
                    $.each( val.images , function( key, val ) {
                        val.alt_url = getImageURL(val.photo_url);
                        item_list.push(val);
                    });
                }
            });
            $.each( item_list , function( key, val ) {
                var repo_rendered = Mustache.render(template_html,val);
                item_rendered.push(repo_rendered);
            });
            
            $(container).show();
            $(container).html(item_rendered.join(''));    
        }
        loadMallDataCached(renderAll); 
    })
</script>